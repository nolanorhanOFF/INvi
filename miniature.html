<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>G√©n√©rateur Miniature Minecraft Ultra Styl√©</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap');

  body {
    margin: 0;
    background: linear-gradient(135deg, #080808, #0f2027);
    color: #eee;
    font-family: 'Luckiest Guy', cursive, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    padding: 20px;
  }

  h1 {
    margin-bottom: 15px;
    text-shadow: 0 0 8px #00fff7aa;
    font-size: 2.8rem;
  }

  #controls {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
    justify-content: center;
    margin-bottom: 20px;
  }

  select, input[type="file"], button {
    padding: 12px 20px;
    border-radius: 30px;
    border: none;
    font-size: 1.1rem;
    outline: none;
    background: #0ff1c0;
    color: #022;
    font-weight: 700;
    box-shadow: 0 0 12px #0ff1c0aa;
    cursor: pointer;
    transition: all 0.3s ease;
    min-width: 170px;
    text-align: center;
  }

  select:hover, input[type="file"]:hover, button:hover {
    background: #0ff1c0ee;
    box-shadow: 0 0 20px #0ff1c0ff;
  }

  canvas {
    border-radius: 30px;
    max-width: 100%;
    box-shadow:
      0 0 15px #00ffe0aa,
      inset 0 0 40px #00ffe0cc;
    background: #121212;
  }

  #downloadBtn {
    margin-top: 15px;
    padding: 14px 50px;
    font-size: 1.3rem;
    border-radius: 40px;
    background: linear-gradient(45deg, #00fff7, #00c7b7);
    border: none;
    color: #022;
    font-weight: 700;
    box-shadow: 0 0 20px #00fff7bb;
    cursor: pointer;
    transition: background 0.3s ease;
    display: none;
  }

  #downloadBtn:hover {
    background: linear-gradient(45deg, #00c7b7, #00fff7);
  }
</style>
</head>
<body>

<h1>Miniature Minecraft Ultra Styl√©e</h1>

<div id="controls">
  <input type="file" id="fileInput" accept="image/*" />
  <select id="game">
    <option value="">Choisis un jeu</option>
    <option value="Minecraft">Minecraft</option>
    <option value="Fortnite">Fortnite</option>
    <option value="Roblox">Roblox</option>
  </select>
  <select id="theme">
    <option value="">Choisis un th√®me</option>
    <option value="D√©fi">D√©fi</option>
    <option value="Troll">Troll</option>
    <option value="Secrets">Secrets</option>
    <option value="Hardcore">Hardcore</option>
    <option value="Mods">Mods</option>
  </select>
  <button id="generateBtn">G√©n√©rer</button>
</div>

<canvas id="canvas" width="1280" height="720"></canvas>

<button id="downloadBtn">T√©l√©charger la miniature</button>

<script>
  const fileInput = document.getElementById('fileInput');
  const gameSelect = document.getElementById('game');
  const themeSelect = document.getElementById('theme');
  const generateBtn = document.getElementById('generateBtn');
  const downloadBtn = document.getElementById('downloadBtn');
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');

  let img = new Image();
  let imgLoaded = false;

  // Chargement de l'image upload√©e
  fileInput.addEventListener('change', e => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(evt) {
      img.src = evt.target.result;
      img.onload = () => {
        imgLoaded = true;
        // Adapter canvas √† l'image (max 1280x720)
        const ratio = img.width / img.height;
        if (img.width > 1280 || img.height > 720) {
          if (ratio > 1280/720) {
            canvas.width = 1280;
            canvas.height = 1280 / ratio;
          } else {
            canvas.height = 720;
            canvas.width = 720 * ratio;
          }
        } else {
          canvas.width = img.width;
          canvas.height = img.height;
        }
        drawBaseImage();
        downloadBtn.style.display = 'none';
      };
    };
    reader.readAsDataURL(file);
  });

  // Fonction pour dessiner l‚Äôimage de base et le cadre lumineux
  function drawBaseImage() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    // Cadre lumineux bleu/cyan
    ctx.lineWidth = 20;
    const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
    gradient.addColorStop(0, '#00fff7');
    gradient.addColorStop(1, '#00c7b7');
    ctx.strokeStyle = gradient;
    ctx.shadowColor = '#00fff7bb';
    ctx.shadowBlur = 20;
    ctx.strokeRect(10, 10, canvas.width - 20, canvas.height - 20);
    ctx.shadowBlur = 0;
  }

  // Dessine un fond pixelis√© style Minecraft
  function drawMinecraftBackground() {
    const blockSize = 40;
    const cols = Math.ceil(canvas.width / blockSize);
    const rows = Math.ceil(canvas.height / blockSize);
    const dirtColors = ['#6B4C1B', '#7A5B28', '#5D3E0F', '#7B5A2B'];
    const grassColors = ['#3A7D21', '#2F6B1B', '#4BA329'];
    for(let y=0; y<rows; y++) {
      for(let x=0; x<cols; x++) {
        let color = dirtColors[Math.floor(Math.random() * dirtColors.length)];
        if (y === 0) color = grassColors[Math.floor(Math.random() * grassColors.length)];
        ctx.fillStyle = color;
        ctx.fillRect(x * blockSize, y * blockSize, blockSize - 2, blockSize - 2);
      }
    }
  }

  // Dessine ic√¥ne Minecraft pixelis√©e en haut gauche
  function drawMinecraftIcon(x, y, size) {
    const pixelSize = size / 8;
    // Couleurs pixel art
    const grassGreen = '#3A7D21';
    const dirtBrown = '#7B5A2B';
    for(let py=0; py<8; py++) {
      for(let px=0; px<8; px++) {
        if (py < 2) ctx.fillStyle = grassGreen;
        else ctx.fillStyle = dirtBrown;
        ctx.fillRect(x + px*pixelSize, y + py*pixelSize, pixelSize-1, pixelSize-1);
      }
    }
    // Ombre sur bloc
    ctx.fillStyle = 'rgba(0,0,0,0.25)';
    ctx.fillRect(x + size*0.6, y + size*0.6, size*0.4, size*0.4);
  }

  // Dessine texte avec effet 3D / ombre port√©e
  function draw3DText(text, x, y, fontSize) {
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.font = `bold ${fontSize}px 'Luckiest Guy', cursive`;
    
    // Ombre port√©e
    ctx.shadowColor = '#00fff7cc';
    ctx.shadowOffsetX = 4;
    ctx.shadowOffsetY = 4;
    ctx.shadowBlur = 8;
    
    // Texte "3D"
    ctx.fillStyle = '#00cc99';
    ctx.fillText(text, x, y);

    // Contour blanc
    ctx.lineWidth = 3;
    ctx.strokeStyle = '#ffffffcc';
    ctx.strokeText(text, x, y);

    // Reset ombre
    ctx.shadowBlur = 0;
    ctx.shadowOffsetX = 0;
    ctx.shadowOffsetY = 0;
  }

  // Gradient sombre en bas pour lisibilit√© du texte
  function drawBottomGradient() {
    const gradHeight = canvas.height * 0.25;
    const gradient = ctx.createLinearGradient(0, canvas.height - gradHeight, 0, canvas.height);
    gradient.addColorStop(0, 'rgba(0,0,0,0)');
    gradient.addColorStop(1, 'rgba(0,0,0,0.85)');
    ctx.fillStyle = gradient;
    ctx.fillRect(0, canvas.height - gradHeight, canvas.width, gradHeight);
  }

  // G√©n√©ration miniature
  generateBtn.addEventListener('click', () => {
    if (!imgLoaded) {
      alert('üö® Merci d\'uploader une image valide !');
      return;
    }
    if (!gameSelect.value || !themeSelect.value) {
      alert('üö® Choisis un jeu et un th√®me stp.');
      return;
    }

    // Dessine fond pixelis√© avec l√©g√®re animation
    drawMinecraftBackground();

    // Dessine image upload√©e par-dessus (avec l√©g√®re transparence)
    ctx.globalAlpha = 0.85;
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    ctx.globalAlpha = 1;

    // Cadre lumineux
    ctx.lineWidth = 20;
    const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
    gradient.addColorStop(0, '#00fff7');
    gradient.addColorStop(1, '#00c7b7');
    ctx.strokeStyle = gradient;
    ctx.shadowColor = '#00fff7bb';
    ctx.shadowBlur = 20;
    ctx.strokeRect(10, 10, canvas.width - 20, canvas.height - 20);
    ctx.shadowBlur = 0;

    // Ic√¥ne Minecraft si jeu = Minecraft
    if (gameSelect.value === 'Minecraft') {
      drawMinecraftIcon(30, 30, 120);
    }

    // Texte en bas
    drawBottomGradient();

    const text = `${gameSelect.value} - ${themeSelect.value}`;
    draw3DText(text, canvas.width / 2, canvas.height - 80, 90);

    // Bouton t√©l√©chargement visible
    downloadBtn.style.display = 'inline-block';
  });

  // Bouton t√©l√©chargement
  downloadBtn.addEventListener('click', () => {
    const link = document.createElement('a');
    link.download = 'miniature_minecraft.png';
    link.href = canvas.toDataURL('image/png', 1.0);
    link.click();
  });
</script>

</body>
</html>
